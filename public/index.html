<!DOCTYPE html>
<html>
<head>
    <title>Image Processing Website</title>
    <style>
        body {
            font-family: sans-serif;
            text-align: center;
        }
        #uploadForm {
            margin-bottom: 20px;
        }
        #resultsContainer {
            margin-top: 20px;
        }
        .resultImage {
            max-width: 500px;
            border: 1px solid #ccc;
            margin: 10px;
        }
    </style>
</head>
<body>
    <h1>Image Processing Website</h1>
    <form id="uploadForm" enctype="multipart/form-data">
        <input type="file" id="imageInput" name="image" accept="image/*">
        <button type="button" onclick="uploadImage()">Process Image</button>
    </form>

    <div id="resultsContainer">
        <h2>Processed Images</h2>
        <div id="imageResults">
          <img id="downloadResult" style="display: none">
          <a id="downloadLink" style="display: none">Download Image</a>
        </div>
    </div>
    <script>
    async function uploadImage() {
        const imageInput = document.getElementById("imageInput");
        const downloadResult = document.getElementById("downloadResult");
        const downloadLinkElement = document.getElementById("downloadLink");

        const file = imageInput.files[0];
        if (!file) {
            alert("Please select an image, you fucking idiot!");
            return;
        }

        const formData = new FormData();
        formData.append('image', file);

        try {
            const response = await fetch('/upscale', {
                method: 'POST',
                body: formData,
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();
            const downloadLink = data.downloadLink;

            if (downloadLink) {
              downloadResult.src = downloadLink;
              downloadResult.style.maxWidth = "500px";
              downloadResult.style.display = "block";

              // Set the download link and show it
              downloadLinkElement.href = downloadLink;
              downloadLinkElement.download = "upscaled_image.png"; // You can set the filename here
              downloadLinkElement.style.display = "inline";

            } else {
                alert("Upscaling failed!");
            }
        } catch (error) {
            console.error("Error uploading image:", error);
            alert("Error uploading image: " + error.message);
        }
    }
    </script>
</body>
</html>
